# QR Scanner iOS/Safari Optimization

## üéØ –ü—Ä–æ–±–ª–µ–º–∞
Shape Detection API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Safari 17.6+ –Ω–∞ iOS, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ QR-–∫–æ–¥–æ–≤ —á–µ—Ä–µ–∑ –∫–∞–º–µ—Ä—É.

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è**
- **jsQR** (–æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è iOS) - 6.5 KB, —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ iOS 12+
- **ZXing** (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ iOS Safari) - –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
- **BarcodeDetector API** - –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏** —Å —Ä–∞–∑–Ω—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

### 2. **–ü–ª–∞—Ç—Ñ–æ—Ä–º–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**
```javascript
// –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
const isSafari = /Safari/.test(navigator.userAgent) && !/Chrome/.test(navigator.userAgent);
const isIOSSafari = isIOS && isSafari;
```

### 3. **–£–ª—É—á—à–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–º–µ—Ä—ã –¥–ª—è iOS**
```javascript
const videoConstraints = isIOSSafari ? {
  video: {
    facingMode: 'environment',
    width: { ideal: 1280, max: 1920 },
    height: { ideal: 720, max: 1080 },
    frameRate: { ideal: 30, max: 60 }
  }
} : {
  video: {
    facingMode: 'environment',
    width: { ideal: 1280 },
    height: { ideal: 720 }
  }
};
```

### 4. **PWA –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
- **Manifest.json** –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–∞ –¥–æ–º–∞—à–Ω–∏–π —ç–∫—Ä–∞–Ω
- **Service Worker** –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
- **iOS meta tags** –¥–ª—è –ª—É—á—à–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ Components/QrScanner/
‚îÇ   ‚îî‚îÄ‚îÄ QrScanner.jsx          # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (—É–ø—Ä–æ—â–µ–Ω)
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ qrProcessor.js         # –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ QR (–Ω–æ–≤—ã–π)
public/
‚îú‚îÄ‚îÄ manifest.json              # PWA –º–∞–Ω–∏—Ñ–µ—Å—Ç (–Ω–æ–≤—ã–π)
‚îú‚îÄ‚îÄ sw.js                      # Service Worker (–Ω–æ–≤—ã–π)
‚îî‚îÄ‚îÄ index.html                 # –û–±–Ω–æ–≤–ª–µ–Ω —Å PWA —Ç–µ–≥–∞–º–∏
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
```javascript
import { processQRImage, getQRSupportInfo } from '../../utils/qrProcessor';

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
const qrCode = await processQRImage(file, {
  enableBackendFallback: false,
  maxAttempts: 8,
  skipZXingOnIOS: true
});
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
```javascript
const supportInfo = getQRSupportInfo();
console.log(supportInfo);
// {
//   isIOS: true,
//   isSafari: true,
//   isIOSSafari: true,
//   hasBarcodeDetector: false,
//   hasZXing: true,
//   hasJsQR: true
// }
```

## üîß –ú–µ—Ç–æ–¥—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞)

1. **jsQR** - –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è iOS
2. **jsQR —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º** - 2x –º–∞—Å—à—Ç–∞–±
3. **jsQR —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–æ–º** - —É–ª—É—á—à–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç
4. **jsQR —á–µ—Ä–Ω–æ-–±–µ–ª—ã–π** - grayscale + contrast
5. **ZXing** - –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ iOS Safari
6. **BarcodeDetector API** - –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
7. **jsQR —Å –∏–Ω–≤–µ—Ä—Å–∏–µ–π** - –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞
8. **–ë—ç–∫–µ–Ω–¥-—Ä–µ–∑–µ—Ä–≤** - –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω

## üì± PWA —Ñ—É–Ω–∫—Ü–∏–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –¥–æ–º–∞—à–Ω–∏–π —ç–∫—Ä–∞–Ω
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –¥–æ–º–∞—à–Ω–∏–π —ç–∫—Ä–∞–Ω
- –†–∞–±–æ—Ç–∞–µ—Ç –≤ standalone —Ä–µ–∂–∏–º–µ
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –æ—Ñ–ª–∞–π–Ω-—Ä–∞–±–æ—Ç—ã

### Service Worker
- –ö—ç—à–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã
- –£–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–∞

## üé® UI/UX —É–ª—É—á—à–µ–Ω–∏—è

- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–º–µ—Ä—ã** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è iOS
- **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏** - —Ä–∞–∑–Ω—ã–µ –¥–ª—è iOS/Android

## üîç –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```javascript
console.log('[QR] –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–¥–µ—Ä–∂–∫–µ:', getQRSupportInfo());
console.log('[QR] –ü–æ–ø—ã—Ç–∫–∞ 1: jsQR...');
console.log('[QR] –£—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω QR-–∫–æ–¥ –º–µ—Ç–æ–¥–æ–º 1:', result);
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Console
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[QR]`

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ú–µ—Ç–æ–¥ | –†–∞–∑–º–µ—Ä | iOS –ø–æ–¥–¥–µ—Ä–∂–∫–∞ | –¢–æ—á–Ω–æ—Å—Ç—å |
|-------|--------|---------------|----------|
| jsQR | 6.5 KB | iOS 12+ | –í—ã—Å–æ–∫–∞—è |
| ZXing | ~300 KB | iOS 15+ | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è |
| BarcodeDetector | –ù–∞—Ç–∏–≤–Ω—ã–π | iOS 15+ | –í—ã—Å–æ–∫–∞—è |

## üö® –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **Shape Detection API** - –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Safari 17.6+
2. **ZXing –Ω–∞ iOS Safari** - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º
3. **BarcodeDetector** - –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ Firefox

## üîÆ –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **WASM-–ø–æ–ª–∏—Ñ–∏–ª** - –¥–ª—è —ç–º—É–ª—è—Ü–∏–∏ BarcodeDetector
2. **–ë—ç–∫–µ–Ω–¥-—Ä–µ–∑–µ—Ä–≤** - –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö QR-–∫–æ–¥–æ–≤
3. **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ** - –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
4. **WebRTC** - –¥–ª—è –ª—É—á—à–µ–π —Ä–∞–±–æ—Ç—ã —Å –∫–∞–º–µ—Ä–æ–π

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ –≥–∞–ª–µ—Ä–µ–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —á–µ—Ä–µ–∑ `getQRSupportInfo()` 